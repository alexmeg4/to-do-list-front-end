<div class="todo-list-container">
  <h1>Todo List</h1>
  <input
    type="text"
    [(ngModel)]="title"
    placeholder="Add a new to-do"
    (keydown.enter)="handleAddTodo()"
  />
  <button (click)="handleAddTodo()">Add Todo</button>
  <div class="todo-columns">
    <div class="todo-column" (dragover)="onDragOver($event)" (drop)="onDrop($event, 'todo')">
      <h2>To Do</h2>
      <div class="todo-cards">
        <div class="todo-card" *ngFor="let todo of todosTodo()" draggable="true"
             (dragstart)="onDragStart($event, todo)"
        >
          <span class="todo-title">{{ todo.title }}</span>
          <div class="card-menu">
            <button class="trash-btn" (click)="todo.showConfirm = true">
              <span class="trash-icon">
                <i class="fa-regular fa-trash-can"></i>
              </span>
            </button>
            <div class="confirm-dialog" *ngIf="todo.showConfirm">
              <span>Delete this card?</span>
              <button class="confirm-btn" (click)="handleDeleteTodo(todo._id)">Confirm</button>
              <button class="cancel-btn" (click)="todo.showConfirm = false">Cancel</button>
            </div>
          </div>
          <div class="todo-actions">
            <button (click)="handleUpdateTodo(todo._id, { status: 'in-progress' })">Start</button>
          </div>
        </div>
      </div>
    </div>
    <div class="todo-column" (dragover)="onDragOver($event)" (drop)="onDrop($event, 'in-progress')">
      <h2>In Progress</h2>
      <div class="todo-cards">
        <div class="todo-card" *ngFor="let todo of todosInProgress()" draggable="true"
             (dragstart)="onDragStart($event, todo)"
        >
          <span class="todo-title">{{ todo.title }}</span>
          <div class="card-menu">
            <button class="trash-btn" (click)="todo.showConfirm = true">
              <span class="trash-icon">
                <!-- SVG trash can icon -->
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="#888"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="3 6 5 6 21 6" />
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m5 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" />
                </svg>
              </span>
            </button>
            <div class="confirm-dialog" *ngIf="todo.showConfirm">
              <span>Delete this card?</span>
              <button class="confirm-btn" (click)="handleDeleteTodo(todo._id)">Confirm</button>
              <button class="cancel-btn" (click)="todo.showConfirm = false">Cancel</button>
            </div>
          </div>
          <div class="todo-actions">
            <button (click)="handleUpdateTodo(todo._id, { status: 'done' })">Complete</button>
            <button (click)="handleUpdateTodo(todo._id, { status: 'todo' })">Back</button>
          </div>
        </div>
      </div>
    </div>
    <div class="todo-column" (dragover)="onDragOver($event)" (drop)="onDrop($event, 'done')">
      <h2>Done</h2>
      <div class="todo-cards">
        <div class="todo-card" *ngFor="let todo of todosDone()" draggable="true"
             (dragstart)="onDragStart($event, todo)"
        >
          <span class="todo-title">{{ todo.title }}</span>
          <div class="card-menu">
            <button class="trash-btn" (click)="todo.showConfirm = true">
              <span class="trash-icon">
                <!-- SVG trash can icon -->
                <svg
                  xmlns="http://www.w3.org/2000/svg"
                  width="20"
                  height="20"
                  viewBox="0 0 24 24"
                  fill="none"
                  stroke="#888"
                  stroke-width="2"
                  stroke-linecap="round"
                  stroke-linejoin="round"
                >
                  <polyline points="3 6 5 6 21 6" />
                  <path d="M19 6v14a2 2 0 0 1-2 2H7a2 2 0 0 1-2-2V6m5 0V4a2 2 0 0 1 2-2h2a2 2 0 0 1 2 2v2" />
                </svg>
              </span>
            </button>
            <div class="confirm-dialog" *ngIf="todo.showConfirm">
              <span>Delete this card?</span>
              <button class="confirm-btn" (click)="handleDeleteTodo(todo._id)">Confirm</button>
              <button class="cancel-btn" (click)="todo.showConfirm = false">Cancel</button>
            </div>
          </div>
          <div class="todo-actions">
            <button (click)="handleUpdateTodo(todo._id, { status: 'in-progress' })">Undo</button>
          </div>
        </div>
      </div>
    </div>
  </div>
</div>